<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <title>Imgfloat Admin</title>
        <meta name="_csrf" th:content="${_csrf.token}" />
        <meta name="_csrf_header" th:content="${_csrf.headerName}" />
        <link rel="icon" href="/favicon.ico" />
        <link rel="stylesheet" href="/css/styles.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
            integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
        <script src="/js/csrf.js"></script>
    </head>
    <body class="settings-body" th:classappend="${isStaging} ? ' has-staging-banner' : ''">
        <div th:insert="~{fragments/staging :: banner}"></div>
        <div class="settings-shell">
            <header class="settings-header">
                <div class="brand">
                    <img class="brand-mark" alt="brand" src="/img/brand.png" />
                    <div>
                        <div class="brand-title">Imgfloat</div>
                        <div class="brand-subtitle">Twitch overlay manager</div>
                    </div>
                </div>
            </header>

            <main class="settings-main">
                <section class="settings-card settings-hero">
                    <div class="hero-copy">
                        <h1>Application defaults</h1>
                        <p class="muted">Global settings for overlay performance and audio.</p>
                    </div>
                    <div class="stat-grid compact">
                        <div class="stat">
                            <p class="stat-label">Canvas FPS</p>
                            <p class="stat-value" id="stat-canvas-fps">--</p>
                        </div>
                        <div class="stat">
                            <p class="stat-label">Canvas max size</p>
                            <p class="stat-value" id="stat-canvas-size">--</p>
                        </div>
                        <div class="stat">
                            <p class="stat-label">Playback speed</p>
                            <p class="stat-value" id="stat-playback-range">--</p>
                        </div>
                        <div class="stat">
                            <p class="stat-label">Audio pitch</p>
                            <p class="stat-value" id="stat-audio-range">--</p>
                        </div>
                        <div class="stat">
                            <p class="stat-label">Volume limits</p>
                            <p class="stat-value" id="stat-volume-range">--</p>
                        </div>
                        <div class="stat">
                            <p class="stat-label">Emote sync</p>
                            <p class="stat-value" id="stat-emote-sync">--</p>
                        </div>
                    </div>
                </section>

                <div class="settings-stack">
                    <section class="settings-card settings-panel">
                        <div class="section-heading">
                            <div>
                                <h2>Performance & audio</h2>
                                <p class="muted tiny">Adjust the global defaults below.</p>
                            </div>
                        </div>

                        <form novalidate id="settings-form" class="settings-form">
                            <div class="form-section">
                                <div class="form-heading">
                                    <h3>Canvas</h3>
                                </div>
                                <div class="control-grid split-row">
                                    <label for="canvas-fps"
                                        >Canvas FPS
                                        <input
                                            id="canvas-fps"
                                            name="canvas-fps"
                                            class="text-input"
                                            type="text"
                                            inputmode="numeric"
                                            pattern="^[1-9]\d*$"
                                            placeholder="60"
                                        />
                                    </label>

                                    <label for="canvas-size"
                                        >Canvas max side length (pixels)
                                        <input
                                            id="canvas-size"
                                            name="canvas-size"
                                            class="text-input"
                                            type="text"
                                            inputmode="numeric"
                                            pattern="^[1-9]\d*$"
                                            placeholder="1920"
                                        />
                                    </label>
                                </div>
                            </div>

                            <div class="form-section">
                                <div class="form-heading">
                                    <h3>Playback</h3>
                                </div>
                                <div class="control-grid split-row">
                                    <label for="min-playback-speed"
                                        >Min playback speed
                                        <input
                                            id="min-playback-speed"
                                            name="min-playback-speed"
                                            class="text-input"
                                            type="text"
                                            inputmode="decimal"
                                            pattern="^(0|[1-9]\d*)(\.\d+)?$"
                                            placeholder="0.5"
                                        />
                                    </label>

                                    <label for="max-playback-speed"
                                        >Max playback speed
                                        <input
                                            id="max-playback-speed"
                                            name="max-playback-speed"
                                            class="text-input"
                                            type="text"
                                            inputmode="decimal"
                                            pattern="^(0|[1-9]\d*)(\.\d+)?$"
                                            placeholder="1.0"
                                        />
                                    </label>
                                </div>
                            </div>

                            <div class="form-section">
                                <div class="form-heading">
                                    <h3>Audio</h3>
                                </div>
                                <div class="control-grid split-row">
                                    <label for="min-audio-pitch"
                                        >Min audio pitch
                                        <input
                                            id="min-audio-pitch"
                                            name="min-audio-pitch"
                                            class="text-input"
                                            type="text"
                                            inputmode="decimal"
                                            pattern="^(0|[1-9]\d*)(\.\d+)?$"
                                            placeholder="0.8"
                                        />
                                    </label>

                                    <label for="max-audio-pitch"
                                        >Max audio pitch
                                        <input
                                            id="max-audio-pitch"
                                            name="max-audio-pitch"
                                            class="text-input"
                                            type="text"
                                            inputmode="decimal"
                                            pattern="^(0|[1-9]\d*)(\.\d+)?$"
                                            placeholder="1.0"
                                        />
                                    </label>
                                </div>
                                <div class="control-grid split-row">
                                    <label for="min-volume"
                                        >Min volume
                                        <input
                                            id="min-volume"
                                            name="min-volume"
                                            class="text-input"
                                            type="text"
                                            inputmode="decimal"
                                            pattern="^(0|[1-9]\d*)(\.\d+)?$"
                                            placeholder="0.2"
                                        />
                                    </label>

                                    <label for="max-volume"
                                        >Max volume
                                        <input
                                            id="max-volume"
                                            name="max-volume"
                                            class="text-input"
                                            type="text"
                                            inputmode="decimal"
                                            pattern="^(0|[1-9]\d*)(\.\d+)?$"
                                            placeholder="1.0"
                                        />
                                    </label>
                                </div>
                            </div>

                            <div class="form-section">
                                <div class="form-heading">
                                    <h3>Emote sync</h3>
                                </div>
                                <div class="control-grid">
                                    <label for="emote-sync-interval"
                                        >Emote sync interval (minutes)
                                        <input
                                            id="emote-sync-interval"
                                            name="emote-sync-interval"
                                            class="text-input"
                                            type="text"
                                            inputmode="numeric"
                                            pattern="^[1-9]\d*$"
                                            placeholder="60"
                                        />
                                    </label>
                                </div>
                            </div>

                            <div class="form-footer">
                                <p id="settings-status" class="status-chip">No changes yet.</p>
                                <button id="settings-submit-button" type="submit" class="button" disabled>
                                    Save settings
                                </button>
                            </div>
                        </form>
                    </section>

                    <section class="settings-card">
                        <div class="form-heading">
                            <h3>System administrators</h3>
                        </div>
                        <div class="inline-form">
                            <input id="new-sysadmin" placeholder="Twitch username" />
                            <button id="add-sysadmin-button" class="button" type="button">Add system admin</button>
                        </div>
                        <div class="card-section">
                            <div class="section-header">
                                <h4 class="list-title">Current system admins</h4>
                            </div>
                            <ul id="sysadmin-list" class="stacked-list"></ul>
                        </div>
                    </section>
                </div>
            </main>
        </div>
        <script th:inline="javascript">
            const serverRenderedSettings = /*[[${settingsJson}]]*/;
            const serverRenderedInitialSysadmin = /*[[${initialSysadmin}]]*/;
        </script>
        <script src="/js/cookie-consent.js"></script>
        <script src="/js/settings.js"></script>
        <script src="/js/toast.js"></script>
    </body>
</html>
