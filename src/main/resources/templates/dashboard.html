<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Imgfloat Dashboard</title>
    <link rel="stylesheet" href="/css/styles.css" />
</head>
<body class="dashboard-body">
<div class="dashboard-shell">
    <header class="dashboard-hero hero hero-compact">
        <div class="hero-text">
            <p class="eyebrow">Dashboard</p>
            <h1>Hello, <span th:text="${username}">user</span></h1>
            <p class="lead">Manage overlay assets, keep your canvas sized correctly, and hand off control to trusted mods.</p>
            <ul class="pill-list minimal">
                <li>Channel: <strong th:text="${channel}">channel</strong></li>
                <li>Secure dashboard</li>
            </ul>
        </div>
        <div class="hero-panel hero-preview">
            <div class="panel-header">
                <div>
                    <p class="eyebrow subtle">Quick actions</p>
                    <h3>Jump into your overlay</h3>
                </div>
                <span class="badge">Live</span>
            </div>
            <div class="preview-summary">
                <p class="muted">Open your broadcast view or delegate control without leaving this page.</p>
            </div>
            <div class="panel-actions">
                <a class="button block" th:href="@{'/view/' + ${channel} + '/broadcast'}">Open broadcast overlay</a>
                <a class="button ghost block" th:href="@{'/view/' + ${channel} + '/admin'}">Open admin console</a>
                <form class="block" th:action="@{/logout}" method="post">
                    <button class="secondary block" type="submit">Logout</button>
                </form>
            </div>
        </div>
    </header>

    <section class="card-grid two-col">
        <div class="card">
            <div class="card-header">
                <div>
                    <p class="eyebrow">Canvas</p>
                    <h3>Overlay size</h3>
                    <p class="muted">Match your OBS output so overlays land where you expect.</p>
                </div>
                <div class="pill">Visible to admins</div>
            </div>
            <div class="control-grid">
                <label>
                    Width
                    <input id="canvas-width" type="number" min="100" step="10" />
                </label>
                <label>
                    Height
                    <input id="canvas-height" type="number" min="100" step="10" />
                </label>
            </div>
            <div class="control-actions">
                <button type="button" onclick="saveCanvasSettings()">Save canvas size</button>
                <span id="canvas-status" class="muted"></span>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <div>
                    <p class="eyebrow">Collaboration</p>
                    <h3>Channel admins</h3>
                    <p class="muted">Invite moderators to help manage assets.</p>
                </div>
            </div>
            <div class="inline-form">
                <input id="new-admin" placeholder="Twitch username" />
                <button type="button" onclick="addAdmin()">Add admin</button>
            </div>
            <div class="card-section">
                <div class="section-header">
                    <p class="eyebrow subtle">Current</p>
                    <h4 class="list-title">Admins</h4>
                </div>
                <ul id="admin-list" class="stacked-list"></ul>
            </div>
            <div class="card-section">
                <div class="section-header">
                    <p class="eyebrow subtle">Suggested</p>
                    <h4 class="list-title">Your Twitch moderators</h4>
                    <p class="muted">Add moderators who already help run your channel.</p>
                </div>
                <ul id="admin-suggestions" class="stacked-list"></ul>
            </div>
        </div>
    </section>

    <section th:if="${adminChannels != null}" class="card">
        <div class="card-header">
            <div>
                <p class="eyebrow">Your access</p>
                <h3>Channels you administer</h3>
                <p class="muted">Jump into a teammate's overlay console.</p>
            </div>
        </div>
        <p th:if="${#lists.isEmpty(adminChannels)}">No admin invitations yet.</p>
        <ul th:if="${!#lists.isEmpty(adminChannels)}" class="stacked-list">
            <li th:each="channelName : ${adminChannels}" class="stacked-list-item">
                <div>
                    <p class="list-title" th:text="${channelName}">channel</p>
                    <p class="muted">Admin access</p>
                </div>
                <a class="button ghost" th:href="@{'/view/' + ${channelName} + '/admin'}">Open</a>
            </li>
        </ul>
    </section>
</div>
<script src="/js/toast.js"></script>
<script th:inline="javascript">
    const broadcaster = /*[[${channel}]]*/ '';
</script>
<script src="/js/dashboard.js"></script>
</body>
</html>
